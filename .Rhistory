names(FLA)<-FLA_names
FLA <- FLA[order(-abs(FLA$logFC)),,drop=FALSE]
FLA_c <- FLA[(duplicated(FLA$SYMBOL,incomparables=NA) | duplicated(FLA$SYMBOL, fromLast = TRUE,incomparables=NA)),]
#FLA_d <- aggregate(FLA_c$logFC,list(FLA_c$SYMBOL),prod)
#FLA_e <- subset(FLA_d,FLA_d$x < 0)
#FLA <- FLA[!FLA$SYMBOL %in% FLA_e[,1],]
FLA <- FLA[!duplicated(FLA$SYMBOL,incomparables=NA),]
FLC_names <- read.table("F.liver.chronic.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
FLC <- read.table("F.liver.chronic.tsv", skip =1, stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(FLC)<-FLC_names
FLC <- FLC[order(-abs(FLC$logFC)),,drop=FALSE]
FLC_c <- FLC[(duplicated(FLC$SYMBOL,incomparables=NA) | duplicated(FLC$SYMBOL, fromLast = TRUE,incomparables=NA)),]
#FLC_d <- aggregate(FLC_c$logFC,list(FLC_c$SYMBOL),prod)
#FLC_e <- subset(FLC_d,FLC_d$x < 0)
#FLC <- FLC[!FLC$SYMBOL %in% FLC_e[,1],]
FLC <- FLC[!duplicated(FLC$SYMBOL,incomparables=NA),]
FHA_names <- read.table("F.hippo.acute.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
FHA <- read.table("F.hippo.acute.tsv", skip =1, stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(FHA)<-FHA_names
FHA <- FHA[order(-abs(FHA$logFC)),,drop=FALSE]
FHA_c <- FHA[(duplicated(FHA$SYMBOL,incomparables=NA) | duplicated(FHA$SYMBOL, fromLast = TRUE,incomparables=NA)),]
#FHA_d <- aggregate(FHA_c$logFC,list(FHA_c$SYMBOL),prod)
#FHA_e <- subset(FHA_d,FHA_d$x < 0)
#FHA <- FHA[!FHA$SYMBOL %in% FHA_e[,1],]
FHA <- FHA[!duplicated(FHA$SYMBOL,incomparables=NA),]
FHC_names <- read.table("F.hippo.chronic.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
FHC <- read.table("F.hippo.chronic.tsv", skip =1, stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(FHC)<-FHC_names
FHC <- FHC[order(-abs(FHC$logFC)),,drop=FALSE]
FHC_c <- FHC[(duplicated(FHC$SYMBOL,incomparables=NA) | duplicated(FHC$SYMBOL, fromLast = TRUE,incomparables=NA)),]
#FHC_d <- aggregate(FHC_c$logFC,list(FHC_c$SYMBOL),prod)
#FHC_e <- subset(FHC_d,FHC_d$x < 0)
#FHC <- FHC[!FHC$SYMBOL %in% FHC_e[,1],]
FHC <- FHC[!duplicated(FHC$SYMBOL,incomparables=NA),
]
F344_liver <- venn.diagram(list(F.liver.acute=FLA$SYMBOL,F.liver.chronic=FLC$SYMBOL), filename=NULL, fill=c("red","orange"), alpha=0.4, lty=3,na="remove",resolution=3000,sub.cex=3,cat.pos = c(0, 0),cex=4,scale=FALSE,rotation.degree=-180
)
grid.newpage()
grid.draw(F344_liver)
w3.list <- cbind.fill(setdiff(FLA$SYMBOL,FLC$SYMBOL), setdiff(FLC$SYMBOL,FLA$SYMBOL),intersect(FLA$SYMBOL,FLC$SYMBOL),fill = NA)
write.csv(w3.list,"FLA.FLC.csv")
pie_data <- data.frame(x=numeric(),y=numeric(),
up=numeric(),
down=numeric(),
conflict=numeric(),
stringsAsFactors=FALSE)
only_acute<- na.omit(FLA[FLA$SYMBOL %in% w3.list[,1],])
up_counts<-sum(only_acute$logFC > 0)
down_counts<-sum(only_acute$logFC < 0)
pie_data[1,3]<-up_counts
pie_data[1,4]<-down_counts
pie_data[1,5] <- 0
only_chronic<- na.omit(FLC[FLC$SYMBOL %in% w3.list[,2],])
up_counts<-sum(only_chronic$logFC > 0)
down_counts<-sum(only_chronic$logFC < 0)
pie_data[2,3]<-up_counts
pie_data[2,4]<-down_counts
pie_data[2,5] <- 0
both_1<- na.omit(FLA[FLA$SYMBOL %in% w3.list[,3],])
both_2<- na.omit(FLC[FLC$SYMBOL %in% w3.list[,3],])
both <- merge(both_1,both_2, by="SYMBOL")
up_counts<-sum(both$logFC.x > 0 & both$logFC.y > 0 )
down_counts<-sum(both$logFC.x < 0 & both$logFC.y < 0)
conflict <- sum(both$logFC.x * both$logFC.y < 0)
conflict_genes <- subset(both, both$logFC.x * both$logFC.y < 0)
pie_data[3,3]<-up_counts
pie_data[3,4]<-down_counts
pie_data[3,5]<-conflict
pie_data$x <- c(-10,0,10)
pie_data$y <- c(0,0,0)
pie_data$radius <- 4.5
pie_data$x <- c(-10,0,10)
pie_data$y <- c(0,0,0)
pie_data$radius <- 4.5
ggplot()+ geom_scatterpie(aes(x=x, y=y, r=radius),
data=pie_data, cols=c("up","down","conflict"), color=NA, alpha=.8) +theme_bw()+
scale_fill_manual(values=c("green", "red", "blue")) +
theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
ggplot()+ geom_scatterpie(aes(x=x, y=y, r=radius),
data=pie_data, cols=c("up","down","conflict"), color=NA, alpha=.8) +theme_bw()+
scale_fill_manual(values=c("blue", "green", "red")) +
theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
pie_data
View(only_acute)
View(only_acute)
View(both)
View(both_1)
View(both)
View(only_chronic)
View(FLA)
View(FLC)
View(FLA)
View(FLA)
View(FLC)
View(FLC)
##### KEGG ############
FLC_kegg_names <- read.table("F.liver.chronic.KEGG.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
FLC_kegg <- read.table("F.liver.chronic.KEGG.tsv", skip =1, colClasses=c("character","character",rep("numeric",3)),stringsAsFactors = FALSE,sep ="\t",quote = "",row.names=1)
names(FLC_kegg)<-FLC_kegg_names
FLC_kegg <- subset(FLC_kegg,FLC_kegg$adj.P.value < 0.01)
FLC_kegg$colour <- ifelse(FLC_kegg$Z.score>=0, "#FF0000", "#7CFC00")
FLC_kegg$width <- "W20"
write.table(FLC_kegg[,-c(1,2,3,4)],"FLC_kegg.txt",row.names = TRUE)
FLA_kegg_names <- read.table("F.liver.acute.KEGG.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
FLA_kegg <- read.table("F.liver.acute.KEGG.tsv", skip =1,  colClasses=c("character","character",rep("numeric",3)),stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(FLA_kegg)<-FLA_kegg_names
FLA_kegg <- subset(FLA_kegg,FLA_kegg$adj.P.value < 0.01)
FLA_kegg$width <- "W20"
FLA_kegg$colour <- ifelse(FLA_kegg$Z.score>=0, "#FF0000", "#7CFC00")
write.table(FLA_kegg[,-c(1,2,3,4)],"FLA_kegg.txt")
FHC_kegg_names <- read.table("F.hippo.chronic.KEGG.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
FHC_kegg <- read.table("F.hippo.chronic.KEGG.tsv", skip =1,  colClasses=c("character","character",rep("numeric",3)),stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(FHC_kegg)<-FHC_kegg_names
FHC_kegg <- subset(FHC_kegg,FHC_kegg$adj.P.value < 0.01)
FHC_kegg$width <- "W20"
FHC_kegg$colour <- ifelse(FHC_kegg$Z.score>=0, "#FF0000", "#7CFC00")
write.table(FHC_kegg[,-c(1,2,3,4)],"FHC_kegg.txt")
FHA_kegg_names <- read.table("F.hippo.acute.KEGG.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
FHA_kegg <- read.table("F.hippo.acute.KEGG.tsv", skip =1,  colClasses=c("character","character",rep("numeric",3)),stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(FHA_kegg)<-FHA_kegg_names
FHA_kegg <- subset(FHA_kegg,FHA_kegg$adj.P.value < 0.01)
FHA_kegg$width <- "W20"
FHA_kegg$colour <- ifelse(FHA_kegg$Z.score>=0, "#FF0000", "#7CFC00")
write.table(FHA_kegg[,-c(1,2,3,4)],"FHA_kegg.txt")
dev.off()
fh_kegg <- cbind.fill(setdiff(FHA_kegg$PathNames,FHC_kegg$PathNames),setdiff(FHC_kegg$PathNames,FHA_kegg$PathNames),intersect(FHC_kegg$PathNames,FHA_kegg$PathNames),fill= NA)
l <- venn.diagram(list(hippo.acute=FHA_kegg$PathNames,hippo.chronic=FHC_kegg$PathNames), filename=NULL, fill=c(4,5), alpha=0.4, lty=3,na="remove",resolution =1000,cex=c(3,3,3),cat.pos=c(30,330),scale=FALSE)
grid.newpage()
grid.draw(l)
dev.off()
l <- venn.diagram(list(hippo.acute=FHA_kegg$PathNames,hippo.chronic=FHC_kegg$PathNames), filename=NULL, fill=c(4,5), alpha=0.4, lty=3,na="remove",resolution =1000,cex=c(3,3,3),cat.pos=c(330,30),scale=FALSE)
grid.newpage()
grid.draw(l)
View(FHA_kegg)
View(FHC_kegg)
View(FLA_kegg)
View(FLA_kegg)
View(FLC_kegg)
hl_kegg <- cbind.fill(setdiff(FLA_kegg$PathNames,FLC_kegg$PathNames),setdiff(FLC_kegg$PathNames,FLA_kegg$PathNames),intersect(FLC_kegg$PathNames,FLA_kegg$PathNames),fill= NA)
l <- venn.diagram(list(liver.acute=FLA_kegg$PathNames,liver.chronic=FLC_kegg$PathNames), filename=NULL, fill=c("red","orange"), alpha=0.4, lty=3,na="remove",resolution =1000,cex=c(3,3,3),cat.pos=c(330,30),scale=FALSE,rotation.degree=180)
grid.newpage()
grid.draw(l)
dev.off()
hl_kegg <- cbind.fill(setdiff(FLA_kegg$PathNames,FLC_kegg$PathNames),setdiff(FLC_kegg$PathNames,FLA_kegg$PathNames),intersect(FLC_kegg$PathNames,FLA_kegg$PathNames),fill= NA)
l <- venn.diagram(list(liver.acute=FLA_kegg$PathNames,liver.chronic=FLC_kegg$PathNames), filename=NULL, fill=c("red","orange"), alpha=0.4, lty=3,na="remove",resolution =1000,cex=c(3,3,3),cat.pos=c(330,30),scale=FALSE)
grid.newpage()
grid.draw(l)
dev.off()
pie_data <- data.frame(x=numeric(),y=numeric(),
up=numeric(),
down=numeric(),
conflict=numeric(),
stringsAsFactors=FALSE)
only_acute <- na.omit(FLA_kegg[FLA_kegg$PathNames %in% hl_kegg[,1],])
up_counts<-sum(only_acute$Z.score > 0)
down_counts<-sum(only_acute$Z.score  < 0)
pie_data[1,3]<-up_counts
pie_data[1,4]<-down_counts
pie_data[1,5] <- 0
only_chronic <- na.omit(FLC_kegg[FLC_kegg$PathNames %in% hl_kegg[,2],])
up_counts<-sum(only_chronic$Z.score > 0)
down_counts<-sum(only_chronic$Z.score  < 0)
pie_data[2,3]<-up_counts
pie_data[2,4]<-down_counts
pie_data[2,5] <- 0
both_1<- na.omit(FLA_kegg[FLA_kegg$PathNames %in% hl_kegg[,3],])
both_2<- na.omit(FLC_kegg[FLC_kegg$PathNames %in% hl_kegg[,3],])
both <- merge(both_1,both_2, by="PathNames")
up_counts<-sum(both$Z.score.x > 0 & both$Z.score.y > 0 )
down_counts<-sum(both$Z.score.x < 0 & both$Z.score.y < 0)
conflict <- sum(both$Z.score.x * both$Z.score.y < 0)
conflict_genes <- subset(both, both$Z.score.x * both$Z.score.y < 0)
pie_data[3,3]<-up_counts
pie_data[3,4]<-down_counts
pie_data[3,5]<-conflict
pie_data$x <- c(-10,0,10)
pie_data$y <- c(0,0,0)
pie_data$radius <- 4.5
ggplot()+ geom_scatterpie(aes(x=x, y=y, r=radius),
data=pie_data, cols=c("up","down","conflict"), color=NA, alpha=.8) +theme_bw()+
scale_fill_manual(values=c("blue", "green", "red")) +
theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
pie_data
kegg_overlap_list <- cbind.fill(only_acute,both,only_chronic,fill=NA)
write.csv(kegg_overlap_list,"kegg_liver_summary.csv")
pie_data <- data.frame(x=numeric(),y=numeric(),
up=numeric(),
down=numeric(),
conflict=numeric(),
stringsAsFactors=FALSE)
only_acute<- na.omit(FLA[FLA$SYMBOL %in% w3.list[,1],])
up_counts<-sum(only_acute$logFC > 0)
down_counts<-sum(only_acute$logFC < 0)
pie_data[1,3]<-up_counts
pie_data[1,4]<-down_counts
pie_data[1,5] <- 0
only_chronic<- na.omit(FLC[FLC$SYMBOL %in% w3.list[,2],])
up_counts<-sum(only_chronic$logFC > 0)
down_counts<-sum(only_chronic$logFC < 0)
pie_data[2,3]<-up_counts
pie_data[2,4]<-down_counts
pie_data[2,5] <- 0
both_1<- na.omit(FLA[FLA$SYMBOL %in% w3.list[,3],])
both_2<- na.omit(FLC[FLC$SYMBOL %in% w3.list[,3],])
both <- merge(both_1,both_2, by="SYMBOL")
up_counts<-sum(both$logFC.x > 0 & both$logFC.y > 0 )
down_counts<-sum(both$logFC.x < 0 & both$logFC.y < 0)
conflict <- sum(both$logFC.x * both$logFC.y < 0)
conflict_genes <- subset(both, both$logFC.x * both$logFC.y < 0)
pie_data[3,3]<-up_counts
pie_data[3,4]<-down_counts
pie_data[3,5]<-conflict
pie_data$x <- c(-10,0,10)
pie_data$y <- c(0,0,0)
pie_data$radius <- 4.5
pie_data
View(w3.list)
setwd("/Volumes/Data/Inflammation_handle_0520")
WLA_names <- read.table("W.liver.acute.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
WLA <- read.table("W.liver.acute.tsv", skip =1, stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(WLA)<-WLA_names
WLA <- WLA[order(-abs(WLA$logFC)),,drop=FALSE]
WLA_c <- WLA[(duplicated(WLA$SYMBOL,incomparables=NA) | duplicated(WLA$SYMBOL, fromLast = TRUE,incomparables=NA)),]
#WLA_d <- aggregate(WLA_c$logFC,list(WLA_c$SYMBOL),prod)
#WLA_e <- subset(WLA_d,WLA_d$x < 0)
#WLA <- WLA[!WLA$SYMBOL %in% WLA_e[,1],]
WLA <- WLA[!duplicated(WLA$SYMBOL,incomparables=NA),]
WLC_names <- read.table("W.liver.chronic.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
WLC <- read.table("W.liver.chronic.tsv", skip =1, stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(WLC)<-WLC_names
WLC <- WLC[order(-abs(WLC$logFC)),,drop=FALSE]
WLC_c <- WLC[(duplicated(WLC$SYMBOL,incomparables=NA) | duplicated(WLC$SYMBOL, fromLast = TRUE,incomparables=NA)),]
#WLC_d <- aggregate(WLC_c$logFC,list(WLC_c$SYMBOL),prod)
#WLC_e <- subset(WLC_d,WLC_d$x < 0)
#WLC <- WLC[!WLC$SYMBOL %in% WLC_e[,1],]
WLC <- WLC[!duplicated(WLC$SYMBOL,incomparables=NA),]
WHA_names <- read.table("W.hippo.acute.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
WHA <- read.table("W.hippo.acute.tsv", skip =1, stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(WHA)<-WHA_names
WHA <- WHA[order(-abs(WHA$logFC)),,drop=FALSE]
WHA_c <- WHA[(duplicated(WHA$SYMBOL,incomparables=NA) | duplicated(WHA$SYMBOL, fromLast = TRUE,incomparables=NA)),]
#WHA_d <- aggregate(WHA_c$logFC,list(WHA_c$SYMBOL),prod)
#WHA_e <- subset(WHA_d,WHA_d$x < 0)
#WHA <- WHA[!WHA$SYMBOL %in% WHA_e[,1],]
WHA <- WHA[!duplicated(WHA$SYMBOL,incomparables=NA),]
WHC_names <- read.table("W.hippo.chronic.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
WHC <- read.table("W.hippo.chronic.tsv", skip =1, stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(WHC)<-WHC_names
WHC <- WHC[order(-abs(WHC$logFC)),,drop=FALSE]
WHC_c <- WHC[(duplicated(WHC$SYMBOL,incomparables=NA) | duplicated(WHC$SYMBOL, fromLast = TRUE,incomparables=NA)),]
#WHC_d <- aggregate(WHC_c$logFC,list(WHC_c$SYMBOL),prod)
#WHC_e <- subset(WHC_d,WHC_d$x < 0)
#WHC <- WHC[!WHC$SYMBOL %in% WHC_e[,1],]
WHC <- WHC[!duplicated(WHC$SYMBOL,incomparables=NA),]
View(WLA)
View(WLC)
w5.list <- cbind.fill(setdiff(FLA$SYMBOL,WLA$SYMBOL), setdiff(WLA$SYMBOL,FLA$SYMBOL),intersect(WLA$SYMBOL,FLA$SYMBOL),fill = NA)
write.csv(w3.list,"/Volumes/Data/Inflammation_bothFLA.WLA.csv")
F344_wistar_liver <- venn.diagram(list(F.liver.acute=FLA$SYMBOL,W.liver.acute=WLA$SYMBOL), filename=NULL, fill=c("red","orange"), alpha=0.4, lty=3,na="remove",resolution=3000,sub.cex=3,cat.pos = c(0, 0),cex=4,scale=FALSE,rotation.degree=-180
)
grid.newpage()
grid.draw(F344_wistar_liver)
only_FLA<- na.omit(FLA[FLA$SYMBOL %in% w5.list[,1],])
up_counts<-sum(only_acute$logFC > 0)
down_counts<-sum(only_acute$logFC < 0)
pie_data[1,3]<-up_counts
pie_data[1,4]<-down_counts
pie_data[1,5] <- 0
only_WLA<- na.omit(WLA[WLA$SYMBOL %in% w5.list[,2],])
up_counts<-sum(only_chronic$logFC > 0)
down_counts<-sum(only_chronic$logFC < 0)
pie_data[2,3]<-up_counts
pie_data[2,4]<-down_counts
pie_data[2,5] <- 0
both_1<- na.omit(FLA[FLA$SYMBOL %in% w5.list[,3],])
both_2<- na.omit(WLA[WLA$SYMBOL %in% w5.list[,3],])
both <- merge(both_1,both_2, by="SYMBOL")
up_counts<-sum(both$logFC.x > 0 & both$logFC.y > 0 )
down_counts<-sum(both$logFC.x < 0 & both$logFC.y < 0)
conflict <- sum(both$logFC.x * both$logFC.y < 0)
conflict_genes <- subset(both, both$logFC.x * both$logFC.y < 0)
pie_data[3,3]<-up_counts
pie_data[3,4]<-down_counts
pie_data[3,5]<-conflict
pie_data$x <- c(-10,0,10)
pie_data$y <- c(0,0,0)
pie_data$radius <- 4.5
ggplot()+ geom_scatterpie(aes(x=x, y=y, r=radius),
data=pie_data, cols=c("up","down","conflict"), color=NA, alpha=.8) +theme_bw()+
scale_fill_manual(values=c("blue", "green", "red")) +
theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
pei_data
pie_data
only_FLA<- na.omit(FLA[FLA$SYMBOL %in% w5.list[,1],])
up_counts<-sum(only_FLA$logFC > 0)
down_counts<-sum(only_FLA$logFC < 0)
pie_data[1,3]<-up_counts
pie_data[1,4]<-down_counts
pie_data[1,5] <- 0
only_WLA<- na.omit(WLA[WLA$SYMBOL %in% w5.list[,2],])
up_counts<-sum(only_WLA$logFC > 0)
down_counts<-sum(only_WLA$logFC < 0)
pie_data[2,3]<-up_counts
pie_data[2,4]<-down_counts
pie_data[2,5] <- 0
both_1<- na.omit(FLA[FLA$SYMBOL %in% w5.list[,3],])
both_2<- na.omit(WLA[WLA$SYMBOL %in% w5.list[,3],])
both <- merge(both_1,both_2, by="SYMBOL")
up_counts<-sum(both$logFC.x > 0 & both$logFC.y > 0 )
down_counts<-sum(both$logFC.x < 0 & both$logFC.y < 0)
conflict <- sum(both$logFC.x * both$logFC.y < 0)
conflict_genes <- subset(both, both$logFC.x * both$logFC.y < 0)
pie_data[3,3]<-up_counts
pie_data[3,4]<-down_counts
pie_data[3,5]<-conflict
pie_data$x <- c(-10,0,10)
pie_data$y <- c(0,0,0)
pie_data$radius <- 4.5
ggplot()+ geom_scatterpie(aes(x=x, y=y, r=radius),
data=pie_data, cols=c("up","down","conflict"), color=NA, alpha=.8) +theme_bw()+
scale_fill_manual(values=c("blue", "green", "red")) +
theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
pie_data
write.csv(w5.list,"/Volumes/Data/Inflammation_both/FLA.WLA.csv")
L.acute.deg.overlap.list <- cbind.fill(only_WLA,both,only_FLA,fill=NA)
write.csv(L.acute.deg.overlap.list,"DEGs_FLA_WLA_summary.csv")
write.csv(L.acute.deg.overlap.list,"/Volumes/Data/Inflammation_both/DEGs_FLA_WLA_summary.csv")
both
F344_wistar_liver_c <- venn.diagram(list(F.liver.chronic=FLC$SYMBOL,W.liver.chronic=WLC$SYMBOL), filename=NULL, fill=c("red","orange"), alpha=0.4, lty=3,na="remove",resolution=3000,sub.cex=3,cat.pos = c(0, 0),cex=4,scale=FALSE,rotation.degree=-180
)
grid.newpage()
grid.draw(F344_wistar_liver_c)
pie_data <- data.frame(x=numeric(),y=numeric(),
up=numeric(),
down=numeric(),
conflict=numeric(),
stringsAsFactors=FALSE)
only_FLC<- na.omit(FLC[FLC$SYMBOL %in% w6.list[,1],])
up_counts<-sum(only_FLC$logFC > 0)
down_counts<-sum(only_FLC$logFC < 0)
pie_data[1,3]<-up_counts
pie_data[1,4]<-down_counts
pie_data[1,5] <- 0
only_WLC<- na.omit(WLC[WLC$SYMBOL %in% w6.list[,2],])
up_counts<-sum(only_WLC$logFC > 0)
down_counts<-sum(only_WLC$logFC < 0)
pie_data[2,3]<-up_counts
pie_data[2,4]<-down_counts
pie_data[2,5] <- 0
both_1<- na.omit(FLC[FLC$SYMBOL %in% w6.list[,3],])
both_2<- na.omit(WLC[WLC$SYMBOL %in% w6.list[,3],])
both <- merge(both_1,both_2, by="SYMBOL")
up_counts<-sum(both$logFC.x > 0 & both$logFC.y > 0 )
down_counts<-sum(both$logFC.x < 0 & both$logFC.y < 0)
conflict <- sum(both$logFC.x * both$logFC.y < 0)
conflict_genes <- subset(both, both$logFC.x * both$logFC.y < 0)
pie_data[3,3]<-up_counts
pie_data[3,4]<-down_counts
pie_data[3,5]<-conflict
pie_data$x <- c(-10,0,10)
pie_data$y <- c(0,0,0)
pie_data$radius <- 4.5
w6.list <- cbind.fill(setdiff(FLC$SYMBOL,WLC$SYMBOL), setdiff(WLC$SYMBOL,FLC$SYMBOL),intersect(WLC$SYMBOL,FLC$SYMBOL),fill = NA)
write.csv(w6.list,"/Volumes/Data/Inflammation_both/FLC.WLC.csv")
pie_data <- data.frame(x=numeric(),y=numeric(),
up=numeric(),
down=numeric(),
conflict=numeric(),
stringsAsFactors=FALSE)
only_FLC<- na.omit(FLC[FLC$SYMBOL %in% w6.list[,1],])
up_counts<-sum(only_FLC$logFC > 0)
down_counts<-sum(only_FLC$logFC < 0)
pie_data[1,3]<-up_counts
pie_data[1,4]<-down_counts
pie_data[1,5] <- 0
only_WLC<- na.omit(WLC[WLC$SYMBOL %in% w6.list[,2],])
up_counts<-sum(only_WLC$logFC > 0)
down_counts<-sum(only_WLC$logFC < 0)
pie_data[2,3]<-up_counts
pie_data[2,4]<-down_counts
pie_data[2,5] <- 0
both_1<- na.omit(FLC[FLC$SYMBOL %in% w6.list[,3],])
both_2<- na.omit(WLC[WLC$SYMBOL %in% w6.list[,3],])
both <- merge(both_1,both_2, by="SYMBOL")
up_counts<-sum(both$logFC.x > 0 & both$logFC.y > 0 )
down_counts<-sum(both$logFC.x < 0 & both$logFC.y < 0)
conflict <- sum(both$logFC.x * both$logFC.y < 0)
conflict_genes <- subset(both, both$logFC.x * both$logFC.y < 0)
pie_data[3,3]<-up_counts
pie_data[3,4]<-down_counts
pie_data[3,5]<-conflict
pie_data$x <- c(-10,0,10)
pie_data$y <- c(0,0,0)
pie_data$radius <- 4.5
ggplot()+ geom_scatterpie(aes(x=x, y=y, r=radius),
data=pie_data, cols=c("up","down","conflict"), color=NA, alpha=.8) +theme_bw()+
scale_fill_manual(values=c("blue", "green", "red")) +
theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
pie_data
L.chronic.deg.overlap.list <- cbind.fill(only_WLC,both,only_FLC,fill=NA)
write.csv(L.chronic.deg.overlap.list,"/Volumes/Data/Inflammation_both/DEGs_FLC_WLC_summary.csv")
View(only_acute)
HA_kegg <- cbind.fill(setdiff(FHA_kegg$PathNames,WHA_kegg$PathNames),setdiff(WHA_kegg$PathNames,FHA_kegg$PathNames),intersect(FHA_kegg$PathNames,WHA_kegg$PathNames),fill= NA)
HC_kegg <- cbind.fill(setdiff(FHC_kegg$PathNames,WHC_kegg$PathNames),setdiff(WHC_kegg$PathNames,FHC_kegg$PathNames),intersect(FHC_kegg$PathNames,WHC_kegg$PathNames),fill= NA)
LA_kegg <- cbind.fill(setdiff(FLA_kegg$PathNames,WLA_kegg$PathNames),setdiff(WLA_kegg$PathNames,FLA_kegg$PathNames),intersect(FLA_kegg$PathNames,WLA_kegg$PathNames),fill= NA)
LC_kegg <- cbind.fill(setdiff(FLC_kegg$PathNames,WLC_kegg$PathNames),setdiff(WLC_kegg$PathNames,WLC_kegg$PathNames),intersect(FLC_kegg$PathNames,WLC_kegg$PathNames),fill= NA)
WLC_kegg_names <- read.table("W.liver.chronic.KEGG.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
WLC_kegg <- read.table("W.liver.chronic.KEGG.tsv", skip =1, colClasses=c("character","character",rep("numeric",3)),stringsAsFactors = FALSE,sep ="\t",quote = "",row.names=1)
names(WLC_kegg)<-WLC_kegg_names
WLC_kegg <- subset(WLC_kegg,WLC_kegg$adj.P.value < 0.01)
WLC_kegg$colour <- ifelse(WLC_kegg$Z.score>=0, "#FF0000", "#7CFC00")
WLC_kegg$width <- "W20"
write.table(WLC_kegg[,-c(1,2,3,4)],"WLC_kegg.txt",row.names = TRUE)
WLA_kegg_names <- read.table("W.liver.acute.KEGG.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
WLA_kegg <- read.table("W.liver.acute.KEGG.tsv", skip =1,  colClasses=c("character","character",rep("numeric",3)),stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(WLA_kegg)<-WLA_kegg_names
WLA_kegg <- subset(WLA_kegg,WLA_kegg$adj.P.value < 0.01)
WLA_kegg$width <- "W20"
WLA_kegg$colour <- ifelse(WLA_kegg$Z.score>=0, "#FF0000", "#7CFC00")
write.table(WLA_kegg[,-c(1,2,3,4)],"WLA_kegg.txt")
WHC_kegg_names <- read.table("W.hippo.chronic.KEGG.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
WHC_kegg <- read.table("W.hippo.chronic.KEGG.tsv", skip =1,  colClasses=c("character","character",rep("numeric",3)),stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(WHC_kegg)<-WHC_kegg_names
WHC_kegg <- subset(WHC_kegg,WHC_kegg$adj.P.value < 0.01)
WHC_kegg$width <- "W20"
WHC_kegg$colour <- ifelse(WHC_kegg$Z.score>=0, "#FF0000", "#7CFC00")
write.table(WHC_kegg[,-c(1,2,3,4)],"WHC_kegg.txt")
WHA_kegg_names <- read.table("W.hippo.acute.KEGG.tsv",nrow=1,stringsAsFactors = FALSE, sep ="\t")
WHA_kegg <- read.table("W.hippo.acute.KEGG.tsv", skip =1,  colClasses=c("character","character",rep("numeric",3)),stringsAsFactors = FALSE,sep ="\t",quote = "",row.names = 1)
names(WHA_kegg)<-WHA_kegg_names
WHA_kegg <- subset(WHA_kegg,WHA_kegg$adj.P.value < 0.01)
WHA_kegg$width <- "W20"
WHA_kegg$colour <- ifelse(WHA_kegg$Z.score>=0, "#FF0000", "#7CFC00")
write.table(WHA_kegg[,-c(1,2,3,4)],"WHA_kegg.txt")
HA_kegg <- cbind.fill(setdiff(FHA_kegg$PathNames,WHA_kegg$PathNames),setdiff(WHA_kegg$PathNames,FHA_kegg$PathNames),intersect(FHA_kegg$PathNames,WHA_kegg$PathNames),fill= NA)
HC_kegg <- cbind.fill(setdiff(FHC_kegg$PathNames,WHC_kegg$PathNames),setdiff(WHC_kegg$PathNames,FHC_kegg$PathNames),intersect(FHC_kegg$PathNames,WHC_kegg$PathNames),fill= NA)
LA_kegg <- cbind.fill(setdiff(FLA_kegg$PathNames,WLA_kegg$PathNames),setdiff(WLA_kegg$PathNames,FLA_kegg$PathNames),intersect(FLA_kegg$PathNames,WLA_kegg$PathNames),fill= NA)
LC_kegg <- cbind.fill(setdiff(FLC_kegg$PathNames,WLC_kegg$PathNames),setdiff(WLC_kegg$PathNames,WLC_kegg$PathNames),intersect(FLC_kegg$PathNames,WLC_kegg$PathNames),fill= NA)
View(HA_kegg)
both_1<- na.omit(FHA_kegg[FHA_kegg$PathNames %in% HA_kegg[,3],])
both_2<- na.omit(WHA_kegg[WHA_kegg$PathNames %in% HA_kegg[,3],])
both <- merge(both_1,both_2, by="PathNames")
up_counts<-sum(both$Z.score.x > 0 & both$Z.score.y > 0 )
down_counts<-sum(both$Z.score.x < 0 & both$Z.score.y < 0)
conflict <- sum(both$Z.score.x * both$Z.score.y < 0)
conflict_genes <- subset(both, both$Z.score.x * both$Z.score.y < 0)
View(both)
both_1<- na.omit(FHC_kegg[FHC_kegg$PathNames %in% HC_kegg[,3],])
both_2<- na.omit(WHC_kegg[WHC_kegg$PathNames %in% HC_kegg[,3],])
both <- merge(both_1,both_2, by="PathNames")
up_counts<-sum(both$Z.score.x > 0 & both$Z.score.y > 0 )
down_counts<-sum(both$Z.score.x < 0 & both$Z.score.y < 0)
conflict <- sum(both$Z.score.x * both$Z.score.y < 0)
conflict_genes <- subset(both, both$Z.score.x * both$Z.score.y < 0)
View(both)
both_1<- na.omit(FLA_kegg[FLA_kegg$PathNames %in% LA_kegg[,3],])
both_2<- na.omit(WLA_kegg[WLA_kegg$PathNames %in% LA_kegg[,3],])
both <- merge(both_1,both_2, by="PathNames")
up_counts<-sum(both$Z.score.x > 0 & both$Z.score.y > 0 )
down_counts<-sum(both$Z.score.x < 0 & both$Z.score.y < 0)
conflict <- sum(both$Z.score.x * both$Z.score.y < 0)
conflict_genes <- subset(both, both$Z.score.x * both$Z.score.y < 0)
View(both)
both_1<- na.omit(FLC_kegg[FLC_kegg$PathNames %in% LC_kegg[,3],])
both_2<- na.omit(WLC_kegg[WLC_kegg$PathNames %in% LC_kegg[,3],])
both <- merge(both_1,both_2, by="PathNames")
up_counts<-sum(both$Z.score.x > 0 & both$Z.score.y > 0 )
down_counts<-sum(both$Z.score.x < 0 & both$Z.score.y < 0)
conflict <- sum(both$Z.score.x * both$Z.score.y < 0)
conflict_genes <- subset(both, both$Z.score.x * both$Z.score.y <
View(both)
View(both)
both_1<- na.omit(FLC_kegg[FLC_kegg$PathNames %in% LC_kegg[,3],])
both_2<- na.omit(WLC_kegg[WLC_kegg$PathNames %in% LC_kegg[,3],])
both <- merge(both_1,both_2, by="PathNames")
up_counts<-sum(both$Z.score.x > 0 & both$Z.score.y > 0 )
down_counts<-sum(both$Z.score.x < 0 & both$Z.score.y < 0)
conflict <- sum(both$Z.score.x * both$Z.score.y < 0)
conflict_genes <- subset(both, both$Z.score.x * both$Z.score.y < 0)
View(both)
setwd("/Volumes/Data/ICSCB_sourcecode/")
library("ggplot2")
